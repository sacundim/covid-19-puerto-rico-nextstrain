
## This YAML file is sparsely commented, with a focus on the parts relevant to multiple inputs
## See my_profiles/example/builds.yaml for more general comments
## See docs/multiple_inputs.md for a walkthrough of this config.

inputs:
  - name: "open"
    metadata: "https://data.nextstrain.org/files/ncov/open/metadata.tsv.gz"
    filtered: "https://data.nextstrain.org/files/ncov/open/filtered.fasta.xz"

builds:
  puerto-rico:
    division: Puerto Rico
    country: USA
    region: North America
    subsampling_scheme: divisional

subsampling:
  divisional:
    division:
      group_by: "year month"
      max_sequences: 2500
      query: --query "(country == '{country}' & division == '{division}')"
    country:
      group_by: "division year month"
      max_sequences: 1500
      query: --query "(country == '{country}' & division != '{division}')"
      priorities:
        type: "proximity"
        focus: "division"
    global:
      group_by: "country year month"
      max_sequences: 1500
      query: --query "country != '{country}'"
      priorities:
        type: "proximity"
        focus: "division"

# GenBank data includes "Wuhan-Hu-1/2019" which we use as the root for this build
# as Wuhan/Hu-1/2019 is not in the data.
refine:
  root: "Wuhan-Hu-1/2019"

files:
  auspice_config: "puerto-rico_profiles/puerto-rico_open/my_auspice_config.json"
  description: "puerto-rico_profiles/puerto-rico_open/my_description.md"
